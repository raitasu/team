import{x as u,t as e,B as k,aE as D,X as f,bg as F,bh as M,ag as A,r as E,ad as S,al as C,aY as _,Y as w,$ as j,Z as I,cq as P,cr as T,cs as $,ae as z,aU as G,af as O,a9 as L,aa as y,ai as B,P as Y}from"./index-b52e60c4.js";import{n as H,F as V,S as q,I as N}from"./index-e9f440b3.js";import{A as U,u as X,h as Z,E as J,g as K}from"./dates.utils-6e33ef55.js";import{u as Q}from"./index-6daba2ff.js";import{d as W}from"./cv.api.slice-0a41192c.js";const ee=[255,255,255,.6],ae=U.reduce((o,t)=>({...o,[t]:[]}),{}),ie=({avatarFile:o,avatarUrl:t,onAvatarChanged:r,status:s,onReset:c})=>{const[m,l]=u.useState(1),[n,i]=u.useState(null),d=u.useRef(null);u.useEffect(()=>{o||(i(o),l(1))},[o,n]);const g=u.useMemo(()=>H(async()=>{const{current:a}=d;if(a){const R=a.getImageScaledToCanvas().toDataURL(),b=await(await fetch(R)).blob();r(new File([b],n.name||"employee_avatar",{type:b.type}))}},500),[r,n]),{getRootProps:h,getInputProps:x,inputRef:v}=X({maxFiles:1,accept:ae,onDrop:([a])=>{a&&(i(a),l(1),r(a))}}),p=a=>{switch(a){case"active":return"var(--chakra-colors-brand-accentGreen)";case"candidate":return"var(--chakra-colors-brand-accentYellow)";case"inactive":return"var(--chakra-colors-brand-accentRed)";default:return"var(--chakra-colors-brand-accentGreen)"}};return e.jsxs(k,{children:[n?e.jsx(Z,{ref:d,image:n,onImageChange:g,onImageReady:g,width:250,height:250,border:0,color:ee,scale:m,crossOrigin:"anonymous",borderRadius:250,style:{border:`10px solid ${p(s)}`,borderRadius:"50%"}}):e.jsx(D,{src:t?`https://team-prod.cybergizer.com${t}`:void 0,variant:s,_hover:{div:{opacity:1}},size:"lg",children:e.jsx(f,{borderRadius:"5px",border:"1px solid var(--chakra-colors-brand-stroke)",bgColor:"#FFFFFF",cursor:"pointer",sx:{position:"absolute",opacity:0},children:e.jsx(f,{...h({onClick:a=>{n&&a.stopPropagation()}}),children:t?e.jsxs(e.Fragment,{children:[e.jsx(F,{id:"EditAvatarIcon",size:50,color:"var(--chakra-colors-brand-ghostGray)"}),e.jsx(M,{id:"DeleteAvatarIcon",size:50,color:"var(--chakra-colors-brand-ghostGray)",onClick:a=>{a.stopPropagation(),r(null)}})]}):e.jsx(A,{id:"AddAvatarIcon",size:64,color:"var(--chakra-colors-brand-ghostGray)"})})})}),e.jsx("input",{...x()}),n&&e.jsx(J,{onEdit:()=>{var a;return(a=v.current)==null?void 0:a.click()},scale:m,onScaleChange:l,onDelete:a=>{c(a),i(null),l(1)}})]})},le=()=>{const[o]=E(),{field:t}=Q({name:"status"}),r=u.useMemo(()=>S.map(s=>({value:s,label:o(`enums:employee_status.${s}`)})),[o]);return e.jsx(V,{label:o("domains:employee.titles.status"),isRequired:!0,children:e.jsx(q,{options:r,isMulti:!1,value:r.find(s=>s.value===t.value),onChange:s=>{s&&t.onChange(s.value)}})})},de=({isOpen:o,onClose:t,employeeId:r})=>{const s=C.useRef(null),[c,{language:m}]=E(),l=_(),[n,{isLoading:i}]=W(),[d,g]=C.useState(""),h=w(j),x=I(j),v=async()=>{if(r===null)return;const p=d===""?`${K(Date.now(),m,B.DateAndTime)}`:d;try{const a=await n({employeeId:r,name:p}).unwrap();l(`${Y.Employees}/${r}/cv/${a}`),x({description:c("domains:cv.actions.cv_saved")})}catch(a){console.error(a),h({description:c("domains:global.errors.descriptions.unknown_error")})}};return e.jsx(P,{isOpen:o,leastDestructiveRef:s,onClose:t,isCentered:!0,children:e.jsx(T,{children:e.jsxs($,{children:[e.jsx(z,{children:e.jsx(G,{variant:"5",children:c("domains:employee.actions.create_cv_confirmation")})}),e.jsx(O,{children:e.jsx(N,{placeholder:c("domains:employee.actions.cv_name"),value:d,onChange:({target:p})=>g(p.value)})}),e.jsxs(L,{children:[e.jsx(y,{variant:"secondaryGhost",ref:s,onClick:t,paddingLeft:"30px",paddingRight:"30px",isDisabled:i,children:c("general_actions:cancel")}),e.jsx(y,{colorScheme:"red",onClick:v,paddingLeft:"30px",paddingRight:"30px",isDisabled:i,isLoading:i,children:c("general_actions:create")})]})]})})})};export{de as C,ie as E,le as a};
